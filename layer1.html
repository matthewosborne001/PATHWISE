<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Layer 1 — Workload Control Engine</title>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Segoe UI',sans-serif;
}

body{
  background:linear-gradient(135deg,#0f1f3d,#1c2f57);
  color:white;
}

.frame{
  border:2px solid #d4af37;
  border-radius:25px;
  margin:15px;
  min-height:calc(100vh - 30px);
  padding:60px 40px;
}

h1{
  text-align:center;
  font-size:42px;
  margin-bottom:50px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
  gap:30px;
}

.card{
  background:rgba(255,255,255,0.05);
  padding:30px;
  border-radius:18px;
  cursor:pointer;
  transition:0.3s;
}

.card:hover{
  transform:translateY(-5px);
  background:rgba(255,255,255,0.08);
}

.card h2{
  color:#f4b942;
  margin-bottom:10px;
}

.back{
  text-align:center;
  margin-top:50px;
}

.back a{
  color:#f4b942;
  text-decoration:none;
}

/* MODAL */

.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.7);
  display:none;
  justify-content:center;
  align-items:center;
}

.modal-content{
  background:#1c2f57;
  padding:40px;
  border-radius:20px;
  width:350px;
  position:relative;
}

.modal-content input{
  width:100%;
  padding:10px;
  margin-bottom:15px;
  border:none;
  border-radius:8px;
}

.modal-content button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:8px;
  background:linear-gradient(45deg,#f4b942,#e0a22f);
  color:white;
  cursor:pointer;
}

.close{
  position:absolute;
  top:10px;
  right:15px;
  cursor:pointer;
  font-size:20px;
}

.assessment-item{
  margin-bottom:10px;
  font-size:14px;
}
</style>
</head>

<body>

<div class="frame">

<h1>Layer 1 — Workload Control Engine</h1>

<div class="grid">

  <div class="card" onclick="openModal()">
    <h2>Add Assessment</h2>
    <p>Create a realistic study plan based on age and difficulty.</p>
  </div>

  <div class="card">
    <h2>Active Assessments</h2>
    <div id="activeList"></div>
  </div>

  <div class="card">
    <h2>Weekly Workload Meter</h2>
    <p>(Connected to Layer 2)</p>
  </div>

  <div class="card">
    <h2>Risk & Collision Alerts</h2>
    <p>(Coming soon)</p>
  </div>

</div>

<div class="back">
  <a href="plus.html">← Back to Plus</a>
</div>

</div>

<!-- MODAL -->

<div class="modal" id="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">×</span>
    <h3 style="margin-bottom:20px;">Add Assessment</h3>

    <input type="text" id="testName" placeholder="Test Name" required>
    <input type="number" id="age" placeholder="Your Age" min="10" max="18" required>
    <input type="number" id="days" placeholder="Days Until Test" min="1" required>
    <input type="number" id="difficulty" placeholder="Difficulty (1-10)" min="1" max="10" required>

    <button onclick="saveAssessment()">Save Assessment</button>
  </div>
</div>

<script>

function openModal(){
  document.getElementById("modal").style.display="flex";
}

function closeModal(){
  document.getElementById("modal").style.display="none";
}

function saveAssessment(){

  const name = document.getElementById("testName").value;
  const age = parseInt(document.getElementById("age").value);
  const days = parseInt(document.getElementById("days").value);
  const difficulty = parseInt(document.getElementById("difficulty").value);

  if(!name || !age || !days || !difficulty) return;

  let baseHours;

  if(age <= 12) baseHours = 0.8;
  else if(age <= 14) baseHours = 1.2;
  else if(age <= 16) baseHours = 1.8;
  else baseHours = 2.5;

  let dailyStudy = (baseHours * difficulty) / days;

  if(dailyStudy > 4) dailyStudy = 4;

  const assessment = {
    name,
    age,
    days,
    difficulty,
    dailyStudy: dailyStudy.toFixed(1)
  };

  let assessments = JSON.parse(localStorage.getItem("assessments")) || [];
  assessments.push(assessment);
  localStorage.setItem("assessments", JSON.stringify(assessments));

  closeModal();
  loadAssessments();
}

function loadAssessments(){
  const list = document.getElementById("activeList");
  list.innerHTML="";

  const assessments = JSON.parse(localStorage.getItem("assessments")) || [];

  if(assessments.length === 0){
    list.innerHTML="No active assessments.";
    return;
  }

  assessments.forEach(a=>{
    const div = document.createElement("div");
    div.className="assessment-item";
    div.innerHTML = `
      <strong>${a.name}</strong><br>
      Daily Study: ${a.dailyStudy}h<br>
      Difficulty: ${a.difficulty}/10
      <hr style="margin:8px 0;border:0;border-top:1px solid rgba(255,255,255,0.1)">
    `;
    list.appendChild(div);
  });
}

loadAssessments();

</script>

</body>
</html>
